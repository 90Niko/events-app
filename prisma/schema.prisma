// Prisma schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql" // change if your DB differs
  url      = env("DATABASE_URL")
}

model Event {
  id                         BigInt    @id @default(autoincrement())
  name                       String
  owner                      String
  description                String?
  venue_name                 String?
  address_line1              String?
  city                       String?
  country                    String?
  event_date                 DateTime?
  start_time                 DateTime?
  end_time                   DateTime?
  timezone                   String?
  reservation_deadline_date  DateTime?
  status                     String?
  url_address                String?  
  ledgers                    EventLedger[]
  @@map("events")
}

enum EntryType {
  income
  expense
}

model EventLedger {
  id             BigInt    @id @default(autoincrement())
  event_id       BigInt
  entry_type     EntryType
  category       String?   @db.VarChar(100)
  description    String?   @db.VarChar(255)
  amount         Decimal   @db.Decimal(12, 2)
  currency       String    @db.Char(3) @default("EUR")
  entry_date     DateTime  @db.Date
  payment_method String?   @db.VarChar(50)
  counterparty   String?   @db.VarChar(150)
  created_at     DateTime  @default(now())
  updated_at     DateTime  @updatedAt

  event Event @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([event_id, entry_date], name: "idx_event_entrydate")
  @@map("event_ledger")
}
